(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11103,        324]
NotebookOptionsPosition[     10450,        304]
NotebookOutlinePosition[     10797,        319]
CellTagsIndexPosition[     10754,        316]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "1", "st", " ", "order", " ", "energy", " ", "correction", " ", "of", " ", 
    "Simple", " ", "Anharmonic", " ", "oscillator"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Constants", " ", "and", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\:0127", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]", " ", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "the", " ", "unperturbed", " ", "wavefunction", " ", "for",
      " ", "the", " ", "nth", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]", "[", 
     RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      FractionBox["1", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["2", "n"], " ", 
         RowBox[{"n", "!"}]}]]], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"2", "m", " ", "\[Omega]", " "}], 
        RowBox[{"\[Pi]", " ", "\:0127"}]], ")"}], 
      FractionBox["1", "4"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"m", " ", "\[Omega]", " ", 
         SuperscriptBox["x", "2"]}], "\:0127"]}]], " ", 
     RowBox[{"HermiteH", "[", 
      RowBox[{"n", ",", 
       RowBox[{
        SqrtBox[
         FractionBox[
          RowBox[{"2", "m", " ", "\[Omega]", " "}], "\:0127"]], "x"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "the", " ", "perturbation", " ", "Hamiltonian"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "'"}], "=", 
     RowBox[{"2", "\[Lambda]", " ", 
      SuperscriptBox["x", "4"]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Define", " ", "the", " ", "integrand", " ", "for", " ", "the", " ", 
      "first"}], "-", 
     RowBox[{"order", " ", "energy", " ", "correction"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"integrand", "[", 
      RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{"\[Psi]", "[", 
        RowBox[{"n", ",", "x"}], "]"}], "]"}], " ", 
      RowBox[{"H", "'"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"n", ",", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Calculate", " ", "the", " ", "first"}], "-", 
     RowBox[{
     "order", " ", "energy", " ", "correction", " ", "for", " ", "the", " ", 
      "nth", " ", "state"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"firstOrderEnergyCorrection", "[", "n_", "]"}], ":=", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"integrand", "[", 
       RowBox[{"n", ",", "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Calculate", " ", "the", " ", "first"}], "-", 
      RowBox[{
      "order", " ", "energy", " ", "correction", " ", "for", " ", "a", " ", 
       "specific", " ", "state"}]}], ",", 
     RowBox[{"e", ".", "g", "."}], ",", 
     RowBox[{"n", "=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"firstOrderEnergyCorrection", "[", "2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.927330476233162*^9, 3.927330501873784*^9}, {
  3.927330696545697*^9, 3.927330704436268*^9}, {3.927330755757324*^9, 
  3.927330756554102*^9}, {3.9273321239845257`*^9, 3.9273322678610334`*^9}, {
  3.9273323010025516`*^9, 3.927332301674588*^9}, {3.9273323359318485`*^9, 
  3.92733233658838*^9}},ExpressionUUID->"aa87335d-8c8d-4f4b-bc7b-\
bf2d2e275b5b"],

Cell[BoxData[
 FractionBox["39", "8"]], "Output",
 CellChangeTimes->{3.927330507795643*^9, 3.927330710186268*^9, 
  3.927330985116412*^9, 3.927332222439141*^9, 3.9273322729547167`*^9, 
  3.927332303689942*^9, 
  3.9273323385568514`*^9},ExpressionUUID->"dc04a9b2-caba-41c8-a11b-\
f22a581a819f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "2", "nd", " ", "order", " ", "energy", " ", "correction", " ", "of", " ", 
    "Simple", " ", "Anharmonic", " ", "oscillator"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Constants", " ", "and", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\:0127", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "the", " ", "unperturbed", " ", "wavefunction", " ", "for",
      " ", "the", " ", "nth", " ", "state"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]", "[", 
     RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      FractionBox["1", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["2", "n"], " ", 
         RowBox[{"n", "!"}]}]]], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"2", "m", " ", "\[Omega]", " "}], 
        RowBox[{"\[Pi]", " ", "\:0127"}]], ")"}], 
      FractionBox["1", "4"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"m", " ", "\[Omega]", " ", 
         SuperscriptBox["x", "2"]}], "\:0127"]}]], " ", 
     RowBox[{"HermiteH", "[", 
      RowBox[{"n", ",", 
       RowBox[{
        SqrtBox[
         FractionBox[
          RowBox[{"2", "m", " ", "\[Omega]", " "}], "\:0127"]], "x"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Define", " ", "the", " ", "perturbation", " ", "Hamiltonian"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "'"}], "=", 
     RowBox[{"2", "\[Lambda]", " ", 
      SuperscriptBox["x", "4"]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Define", " ", "the", " ", "integrand", " ", "for", " ", "the", " ", 
       "transition", " ", "matrix", " ", "element"}], "<", "k"}], "|", 
     RowBox[{"H", "'"}], "|", 
     RowBox[{"n", ">"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"integrand", "[", 
      RowBox[{"n_", ",", "k_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{"\[Psi]", "[", 
        RowBox[{"k", ",", "x"}], "]"}], "]"}], " ", 
      RowBox[{"H", "'"}], " ", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"n", ",", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Calculate", " ", "the", " ", "transition", " ", "matrix", " ", 
       "element"}], "<", "k"}], "|", 
     RowBox[{"H", "'"}], "|", 
     RowBox[{"n", ">"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"transitionElement", "[", 
     RowBox[{"n_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"integrand", "[", 
       RowBox[{"n", ",", "k", ",", "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "the", " ", "unperturbed", " ", "energy", " ", "levels"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["E", "0"], "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "+", 
       FractionBox["1", "2"]}], ")"}], " ", "\:0127", " ", "\[Omega]"}]}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Calculate", " ", "the", " ", "second"}], "-", 
     RowBox[{
     "order", " ", "energy", " ", "correction", " ", "for", " ", "the", " ", 
      "nth", " ", "state"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"secondOrderEnergyCorrection", "[", "n_", "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "k"}], ",", "0", ",", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"transitionElement", "[", 
            RowBox[{"n", ",", "k"}], "]"}], "]"}], "2"], 
         RowBox[{
          RowBox[{
           SubscriptBox["E", "0"], "[", "n", "]"}], "-", 
          RowBox[{
           SubscriptBox["E", "0"], "[", "k", "]"}]}]]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "10"}], "}"}]}], " ", "]"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Calculate", " ", "the", " ", "second"}], "-", 
      RowBox[{
      "order", " ", "energy", " ", "correction", " ", "for", " ", "a", " ", 
       "specific", " ", "state"}]}], ",", 
     RowBox[{"e", ".", "g", "."}], ",", 
     RowBox[{"n", "=", "0"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"secondOrderEnergyCorrection", "[", "2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9273323967204447`*^9, 3.927332459862687*^9}, {
  3.9273325011567955`*^9, 
  3.9273325253286963`*^9}},ExpressionUUID->"db9ab227-7a82-4314-82b5-\
70f2b6c8f86a"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["615", "32"]}]], "Output",
 CellChangeTimes->{
  3.927332463409294*^9, {3.927332505188034*^9, 
   3.9273325285005693`*^9}},ExpressionUUID->"b5dce9ee-cd6f-493e-ab8b-\
d4461d5c46d9"]
}, Open  ]]
},
WindowSize->{759, 697},
WindowMargins->{{Automatic, 27}, {28, Automatic}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4029, 108, 441, "Input",ExpressionUUID->"aa87335d-8c8d-4f4b-bc7b-bf2d2e275b5b"],
Cell[4612, 132, 293, 6, 55, "Output",ExpressionUUID->"dc04a9b2-caba-41c8-a11b-f22a581a819f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4942, 143, 5266, 150, 619, "Input",ExpressionUUID->"db9ab227-7a82-4314-82b5-70f2b6c8f86a"],
Cell[10211, 295, 223, 6, 88, "Output",ExpressionUUID->"b5dce9ee-cd6f-493e-ab8b-d4461d5c46d9"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

